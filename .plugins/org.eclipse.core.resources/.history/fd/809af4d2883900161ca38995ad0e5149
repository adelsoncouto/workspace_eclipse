<?php

require_once "model/Animal.php";
require_once "model/Categoria.php";

class MainController
{
	public function __construct()
	{
		if(empty($_SESSION['categoria']))
		{
			$agua  = new Categoria('Água');
			$terra = new Categoria('Terra');
			
			$tubarao = new Animal(0, 'tubarao', null);
			$macaco = new Animal(0, 'macaco', null);
			
			$terra->addFilho($macaco);
			$agua->addFilho($tubarao);
			
			$categorias = [serialize($agua), serialize($terra)];
			
			$_SESSION['categoria'] = $categorias;
			$_SESSION['pai'] = null;
			$_SESSION['eu'] = null;
		}
		
	}

	public function init()
	{
		require_once "view/inicio.php";
	}
	
	public function start()
	{
		$_SESSION['pai'] = $_SESSION['categoria'][0];
		
		$pai = unserialize($_SESSION['pai']);
		
		$_SESSION['eu'] = serialize($pai->getFilhos()[0]);
		
		$_REQUEST['msg'] = $pai->getPergunta();
		
		require_once "view/pergunta.php";
	}
	
	public function pergunta()
	{
		$pai = unserialize($_SESSION['pai']);
		$eu  = unserialize($_SESSION['eu']);
// 		print_r($pai);
// 		print_r($eu);
		
		if($_GET['resp'] == 'sim'){
			if(empty($eu->getFilhos())){
				$_REQUEST['msg'] = "O animal que você pensou é ".$eu->getNome().'?';
			}else{
				$_REQUEST['msg'] = 'a';
			}
		}else{
			foreach($pai->getFilhos() as $filho){
				
			}
			
		}
		require_once "view/pergunta.php";
	}
	
}